import CrawlState, { Exploit } from '../state.ts'
import { setupState, jack } from '../../utilities/testing/crew.ts'
import getExploits from './get.ts'
import addExploit from './add.ts'

describe('addExploit',  () => {
  let state: CrawlState
  const exploit: Exploit = {
    history: 'Calico Jack slipped past a Spanish warship.',
    legend: ['Calico Jack captured a Spanish warship.']
  }

  beforeEach(() => {
    state = setupState()
  })

  it('adds to a captainâ€™s exploits', async () => {
    const updated = await addExploit(jack, exploit, state, false)
    expect(await getExploits(jack, updated)).toEqual([exploit])
  })
})
